// Generated by CoffeeScript 1.6.1
(function() {

  (function($) {
    var handleSubmitAnswerError, handleSubmitAnswerSuccess, submitAnswer, submitAnswerAndClose, titleClickHandler;
    titleClickHandler = function(event) {
      var $body, bodyId;
      $(".cancellation-question-bodies:visible").slideUp();
      $(".cancellation-question-body").hide();
      bodyId = $(this).data("bodyid");
      $body = $("#" + bodyId).show();
      return $(".cancellation-question-bodies").slideDown();
    };
    $('.cancellation-question-title input[type="radio"]').click(titleClickHandler);
    submitAnswer = function() {
      var payload;
      payload = {
        title: $("input.cancellation-question-title:checked").val(),
        body: $(".cancellation-answer-body").val(),
        accountName: window.cancellationQuestions.accountName,
        accountEmail: window.cancellationQuestions.accountEmail
      };
      return $.ajax({
        type: 'POST',
        url: "/api/cancellationAnswer",
        data: JSON.stringify(payload),
        dataType: "json",
        contentType: "application/json",
        success: handleSubmitAnswerSuccess,
        error: handleSubmitAnswerError
      });
    };
    submitAnswerAndClose = function() {
      $('#confirmCancel').val('yes');
      return submitAnswer();
    };
    handleSubmitAnswerSuccess = function(resp) {
      if ($("#askCancellationQuestions #confirmCancel").val() === 'yes') {
        return window.location = window.cancellationQuestions.cancelUrl;
      } else {
        $("#askCancellationQuestions").hide();
        return $(".cancellation-confirmation").show();
      }
    };
    handleSubmitAnswerError = function(err) {
      return alert("Error submitting answer. " + err);
    };
    $('#askCancellationQuestions .submit-no-close').click(submitAnswer);
    return $('#askCancellationQuestions .submit-and-close').click(submitAnswerAndClose);
  })(jQuery);

}).call(this);
